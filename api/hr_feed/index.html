<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>HR Feed Endpoints - Figshare User Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "HR Feed Endpoints";
    var mkdocs_page_input_path = "api/hr_feed.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Figshare User Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">figshare Documentation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../oauth/">OAuth</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">OAI PMH</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../OAI-PMH/">OAI-PMH</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Search</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Search/search/">Search</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Stats</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Stats/">Index</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Stats/breakdown/">Breakdown</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Stats/timeline/">Timeline</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Stats/tops/">Tops</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Stats/totals/">Totals</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Api</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">API feature list</a>
                </li>
                <li class="">
                    
    <a class="" href="../articles/">Article endpoints</a>
                </li>
                <li class="">
                    
    <a class="" href="../categories/">Categories public endpoint (no OAuth required)</a>
                </li>
                <li class="">
                    
    <a class="" href="../collections/">Collection endpoints</a>
                </li>
                <li class="">
                    
    <a class="" href="../file_uploader/">File uploader</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">HR Feed Endpoints</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#hr-feed-endpoints">HR Feed Endpoints</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#hrfeed-private-endpoints">HRFeed Private Endpoints</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../institution_and_groups/">Information about institution and groups</a>
                </li>
                <li class="">
                    
    <a class="" href="../licenses/">List licenses</a>
                </li>
                <li class="">
                    
    <a class="" href="../projects/">Projects</a>
                </li>
                <li class="">
                    
    <a class="" href="../upload_example/">Example Upload on fig**share**</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Presenters</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/article/">Article</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/author/">AuthorPresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/category/">CategoryPresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/collaborator/">Collaborator</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/collection/">Collection</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/custom_field/">CustomArticleFieldPresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/file/">Public File Presenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/group/">GroupPresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/institution/">InstitutionPresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/license/">LicensePresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/note/">Note</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/private_link/">PrivateLinkPresenter</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/project/">Project</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../presenters/project_article/">ProjectArticlePresenter</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Figshare User Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Api &raquo;</li>
        
      
    
    <li>HR Feed Endpoints</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="hr-feed-endpoints">HR Feed Endpoints</h1>
<ul>
<li><strong><a href="#hrfeed-private-endpoints">Private</a></strong></li>
<li><a href="#upload-hrfeed-file">upload hrfeed file</a></li>
</ul>
<h2 id="hrfeed-private-endpoints">HRFeed Private Endpoints</h2>
<h3 id="upload-hrfeed-file">Upload HRFeed File</h3>
<h4 id="request">Request</h4>
<pre><code class="http">POST /v2/institution/hrfeed/upload
</code></pre>

<p>The request needs to be of type <code>multipart/form-data</code> and have its <strong>Content-Type</strong> header set to the same value; the body of the file is sent as the form data.
A typical request looks like this:</p>
<pre><code class="http">POST /v2/institution/hrfeed/upload HTTP/1.1
Host: api.figshare.com
Content-Length: 975
Accept-Encoding: gzip, deflate
Accept: */*
User-Agent: python-requests/2.5.3 CPython/2.7.10 Linux/4.1.4-1-ARCH
Connection: keep-alive
Content-Type: multipart/form-data; boundary=529448d158064de596afd8f892c84e15
Authorization: token 86bbaa5d6d51fc0ae2f2defd3a474dac77ae27179ff6d04dd37e74c531bd6ed059eda584b41356337c362a259e482eb36a34825c805344e0600bb875a77444df

--529448d158064de596afd8f892c84e15
Content-Disposition: form-data; name=&quot;hrfeed&quot;; filename=&quot;feed.xml&quot;

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;HRFeed&gt;
    &lt;Record&gt;
        &lt;UniqueID&gt;1234567&lt;/UniqueID&gt;
        &lt;FirstName&gt;Jane&lt;/FirstName&gt;
        &lt;LastName&gt;Doe&lt;/LastName&gt;
        &lt;Title&gt;Mrs&lt;/Title&gt;
        &lt;Initials&gt;JD&lt;/Initials&gt;
        &lt;Suffix&gt;&lt;/Suffix&gt;
        &lt;Email&gt;j.doe@sillymail.io&lt;/Email&gt;
        &lt;IsActive&gt;Y&lt;/IsActive&gt;
        &lt;UserQuota&gt;1048576000&lt;/UserQuota&gt;
        &lt;UserAssociationCriteria&gt;IT&lt;/UserAssociationCriteria&gt;
    &lt;/Record&gt;
    &lt;Record&gt;
        &lt;UniqueID&gt;1234568&lt;/UniqueID&gt;
        &lt;FirstName&gt;John&lt;/FirstName&gt;
        &lt;LastName&gt;Smith&lt;/LastName&gt;
        &lt;Title&gt;Mr&lt;/Title&gt;
        &lt;Initials&gt;&lt;/Initials&gt;
        &lt;Suffix&gt;&lt;/Suffix&gt;
        &lt;Email&gt;js@seriousness.com&lt;/Email&gt;
        &lt;IsActive&gt;Y&lt;/IsActive&gt;
        &lt;UserQuota&gt;10485760000&lt;/UserQuota&gt;
        &lt;UserAssociationCriteria&gt;&lt;/UserAssociationCriteria&gt;
    &lt;/Record&gt;
&lt;/HRFeed&gt;

--529448d158064de596afd8f892c84e15--

</code></pre>

<h4 id="examples">Examples</h4>
<p>The following examples all have the final goal of generating and issuing the upper <strong>HTTP</strong> request.</p>
<h5 id="python">Python</h5>
<p>One of the simpler examples is in <em>python</em>. For this to work one would need to install the <em>requests</em> python package.</p>
<pre><code class="python">#!/usr/bin/env python

import requests


FILE_NAME = 'feed.xml'
API_URL = 'https://api.figshare.com/v2/institution/hrfeed/upload'
TOKEN = '86bbaa5d6d51fc0ae2f2defd3a474dac77ae27179ff6d04dd37e74c531bd6ed059eda584b41356337c362a259e482eb36a34825c805344e0600bb875a77444df'


def main():
    headers = {&quot;Authorization&quot;: &quot;token &quot; + TOKEN}
    with open(FILE_NAME, 'rb') as fin:
        files = {'hrfeed': (FILE_NAME, fin)}
        resp = requests.post(API_URL, files=files, headers=headers)

        print(resp.content)

        resp.raise_for_status()

if __name__ == '__main__':
    main()

</code></pre>

<h5 id="java">Java</h5>
<p>For java one can use apache <em>httpcomponents</em>:</p>
<pre><code class="java">import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.lang.Throwable;

import org.apache.http.HttpEntity;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.ContentType;
import org.apache.http.entity.mime.MultipartEntityBuilder;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;

public class HRFeedUploaderExample {
    public static void main(String[] args) {
        try {
            HRFeedUploaderExample hfue = new HRFeedUploaderExample(args[0]);
            hfue.upload();
        } catch (Throwable t) {
            t.printStackTrace(System.err);
        }
    }

    private static final String API_URL = &quot;https://api.figshare.com/v2/institution/hrfeed/upload&quot;;
    private static final String TOKEN = &quot;86bbaa5d6d51fc0ae2f2defd3a474dac77ae27179ff6d04dd37e74c531bd6ed059eda584b41356337c362a259e482eb36a34825c805344e0600bb875a77444df&quot;;

    private String fileName = null;

    HRFeedUploaderExample(String fileName) {
        this.fileName = fileName;
    }

    public void upload() throws IOException {
        CloseableHttpClient httpClient = HttpClients.createDefault();
        HttpPost uploadFile = new HttpPost(API_URL);

        uploadFile.addHeader(&quot;Authorization&quot;, &quot;token &quot; + TOKEN);

        MultipartEntityBuilder builder = MultipartEntityBuilder.create();
        File file = new File(fileName);

        builder.addBinaryBody(&quot;hrfeed&quot;, new FileInputStream(file), ContentType.TEXT_PLAIN, file.getName());

        HttpEntity multipart = builder.build();
        uploadFile.setEntity(multipart);

        CloseableHttpResponse response = httpClient.execute(uploadFile);
        int status = response.getStatusLine().getStatusCode();

        System.out.println(&quot;Status code was: &quot; + status);
    }
}
</code></pre>

<p>Or if you don't mind getting down and dirty with raw <strong>HTTP</strong>:</p>
<pre><code class="java">import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.lang.Throwable;
import java.net.URL;
import java.net.HttpURLConnection;

public class HRFeedUploaderExample {
    public static void main(String[] args) {
        try {
            HRFeedUploaderExample hfue = new HRFeedUploaderExample(args[0]);
            hfue.upload();
        } catch (Throwable t) {
            t.printStackTrace(System.err);
        }
    }

    private static final String API_URL = &quot;https://api.figshare.com/v2/institution/hrfeed/upload&quot;;
    private static final String TOKEN = &quot;86bbaa5d6d51fc0ae2f2defd3a474dac77ae27179ff6d04dd37e74c531bd6ed059eda584b41356337c362a259e482eb36a34825c805344e0600bb875a77444df&quot;;

    private String fileName = null;

    HRFeedUploaderExample(String fileName) {
        this.fileName = fileName;
    }

    public void upload() throws IOException {
        HttpURLConnection con = (HttpURLConnection) new URL(API_URL).openConnection();
        String boundary = &quot;123456789boundary987654321&quot;;
        byte[] byteBoundary = (&quot;\n--&quot; + boundary + &quot;\n&quot;).getBytes(&quot;UTF-8&quot;);

        con.setDoOutput(true);
        con.setRequestProperty(&quot;Content-Type&quot;, &quot;multipart/form-data; boundary=&quot; + boundary);
        con.setRequestProperty(&quot;Authorization&quot;, &quot;token &quot; + TOKEN);

        File file = new File(fileName);
        try (OutputStream out = con.getOutputStream()) {
            out.write(byteBoundary);
            out.write((&quot;Content-Disposition: form-data; name=\&quot;hrfeed\&quot;; filename=\&quot;&quot; + fileName + &quot;\&quot;\n\n&quot;).getBytes(&quot;UTF-8&quot;));
            try (FileInputStream in = new FileInputStream(file)) {
                byte[] data = new byte[(int) file.length()];
                in.read(data);
                out.write(data);
            }
            out.write(byteBoundary);
        }
        int status = con.getResponseCode();
        System.out.println(&quot;Status code was: &quot; + status);
    }
}
</code></pre>

<h5 id="c">C#</h5>
<p>For the <strong>.NET / mono</strong> users there's this snippet of code:</p>
<pre><code class="Csharp">
using System;
using System.Net.Http;
using System.IO;
using System.Threading.Tasks;

namespace HRFeedUploadExample
{
  class MainClass
  {
    private const String API_URL = &quot;https://api.figshare.com/v2/institution/hrfeed/upload&quot;;
    private const String TOKEN = &quot;86bbaa5d6d51fc0ae2f2defd3a474dac77ae27179ff6d04dd37e74c531bd6ed059eda584b41356337c362a259e482eb36a34825c805344e0600bb875a77444df&quot;;
    private String fileName = null;

    public static void Main (string[] args)
    {
      MainClass app = new MainClass (args [0]);
      app.Upload ();
    }

    MainClass(String fileName) {
      this.fileName = fileName;
    }

    public void Upload() {
      HttpClient httpClient = new HttpClient ();
      httpClient.DefaultRequestHeaders.Add (&quot;Authorization&quot;, &quot;token &quot; + MainClass.TOKEN);

      MultipartFormDataContent form = new MultipartFormDataContent ();
      using (StreamReader sr = new StreamReader (this.fileName)) {
        String content = sr.ReadToEnd ();
        byte[] data = System.Text.Encoding.UTF8.GetBytes (content);

        form.Add (new ByteArrayContent (data, 0, data.Length), &quot;hrfeed&quot;, this.fileName);
      }

      Task&lt;HttpResponseMessage&gt; task = httpClient.PostAsync (MainClass.API_URL, form);
      task.Wait();
      HttpResponseMessage response = task.Result;
      response.EnsureSuccessStatusCode();

      Console.WriteLine (&quot;Status code was: &quot; + response.StatusCode);

      httpClient.Dispose();
    }
  }
}
</code></pre>

<h5 id="curl">CURL</h5>
<p>Probably one of the most versatile ways of uploading an HRFeed is through <strong>curl</strong> given the possibility
of integrating it into any other command line utility on linux/unix.</p>
<pre><code class="curl">curl -XPOST\
    -H&quot;Authorization: token 86bbaa5d6d51fc0ae2f2defd3a474dac77ae27179ff6d04dd37e74c531bd6ed059eda584b41356337c362a259e482eb36a34825c805344e0600bb875a77444df&quot;\
    -F&quot;hrfeed=@feed.csv&quot;\
    https://api.figshare.com/v2/institution/hrfeed/upload
</code></pre>

<h4 id="response">Response</h4>
<ul>
<li>Status: <code>200 OK</code></li>
<li>
<p>Body:</p>
<p><code>json
{
    "message": "OK"
}</code></p>
</li>
</ul>
<h4 id="errors">Errors</h4>
<p>Standard <a href="../#errors">error responses</a>
Most common:</p>
<pre><code class="json">{
    &quot;message&quot;: &quot;Previous feed import not complete.&quot;,
    &quot;data&quot;: null,
    &quot;errcode&quot;: &quot;FigshareAPIException&quot;
}
</code></pre>

<p>when the feed has already been submitted within a 24 hour span.</p>
<h4 id="notes">Notes</h4>
<p>The <em>success</em> response doesn't give much information other than the fact that the system has
understood the request, has received the file and has initiated the necessary tasks.
There are plans for a way to get more in depth information for the state of the <strong>HRFeed Process</strong>.</p>
<p>The <em>token</em> given in the upper examples is a general fig<strong>share</strong> API personal token of any of
the admins at the institution. No other user should be able to access this endpoint, apart from
those given the express permission of uploading HR feeds.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../institution_and_groups/" class="btn btn-neutral float-right" title="Information about institution and groups">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../file_uploader/" class="btn btn-neutral" title="File uploader"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../file_uploader/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../institution_and_groups/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../fig.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
